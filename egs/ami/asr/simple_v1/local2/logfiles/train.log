# Running on r7n03
# Started at Mon May 17 12:50:54 EDT 2021
# /home/hltcoe/aarora/miniconda3/envs/k2/bin/python3 mmi_bigram_train_1b.py 
World size: 1 Rank: 0
Added key: store_based_barrier_key:1 to store for rank: 0
Loading L.fst
About to get train cuts
About to get dev cuts
Using BucketingSampler.
About to create train dataloader
About to create dev dataset
Traceback (most recent call last):
  File "mmi_bigram_train_1b.py", line 493, in <module>
    main()
  File "mmi_bigram_train_1b.py", line 326, in main
    validate = K2SpeechRecognitionDataset(cuts_dev)
  File "/home/hltcoe/aarora/lhotse/lhotse/dataset/speech_recognition.py", line 94, in __init__
    validate_for_asr(self.cuts)
  File "/home/hltcoe/aarora/lhotse/lhotse/dataset/speech_recognition.py", line 156, in validate_for_asr
    assert supervision.duration <= cut.duration + tol, f"Supervisions ending after the cut " \
AssertionError: Supervisions ending after the cut are not supported for ASR (sup id: AMI_IB4004_H03_MIO039_0036179_0036400, cut id: 1a2fc5e3-13c6-4761-b115-34c5e4d87da9)
# Accounting: time=25 threads=1
# Finished at Mon May 17 12:51:19 EDT 2021 with status 1


  {
    "id": "1a2fc5e3-13c6-4761-b115-34c5e4d87da9",
    "start": 361.79,
    "duration": 0.49,
    "channel": 0,
    "supervisions": [
      {
        "id": "AMI_IB4004_H03_MIO039_0036179_0036400",
        "recording_id": "AMI_IB4004_H03",
        "start": 0.0,
        "duration": 2.2099999999999795,
        "channel": 0,
        "text": "YEAH THAT'S THAT'S A POSSIBLE",
        "speaker": "AMI_IB4004_H03_MIO039-01"
      },
      {
        "id": "AMI_IB4004_H03_MIO039_0036179_0036228",
        "recording_id": "AMI_IB4004_H03",
        "start": 0.0,
        "duration": 0.48999999999995225,
        "channel": 0,
        "text": "UH",
        "speaker": "AMI_IB4004_H03_MIO039-01"
      }
    ],
    "features": {
      "type": "fbank",
      "num_frames": 49,
      "num_features": 80,
      "frame_shift": 0.01,
      "sampling_rate": 16000,
      "start": 361.79,
      "duration": 0.49,
      "storage_type": "lilcom_hdf5",
      "storage_path": "exp/data/feats_ami_dev/feats-3.h5",
      "storage_key": "8fb1d662-9a12-4100-a488-8c7e7445edd3",
      "channels": 0
    },
    "recording": {
      "id": "AMI_IB4004_H03",
      "sources": [
        {
          "type": "command",
          "channels": [
            0
          ],
          "source": "sox -c 1 -t wavpcm -e signed-integer /export/common/data/corpora/amicorpus/IB4004/audio/IB4004.Headset-3.wav -t wavpcm - "
        }
      ],
      "sampling_rate": 16000,
      "num_samples": 38285312,
      "duration": 2392.832
    },
    "type": "Cut"
  }
